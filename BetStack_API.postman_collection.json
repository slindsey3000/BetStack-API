{
	"info": {
		"_postman_id": "betstack-api-v1",
		"name": "BetStack API",
		"description": "Complete API collection for BetStack - Sports & Sports Betting Data API\n\nBase URLs:\n- Local: http://localhost:3000\n- Production: https://betstack-45ae7ff725cd.herokuapp.com",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:3000",
			"type": "string"
		},
		{
			"key": "production_url",
			"value": "https://betstack-45ae7ff725cd.herokuapp.com",
			"type": "string"
		},
		{
			"key": "edge_url",
			"value": "https://api.betstack.dev",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "Sports",
			"item": [
				{
					"name": "Get All Sports",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/sports",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "sports"]
						},
						"description": "Get all sports. Returns 12 sports (American Football, Baseball, Basketball, etc.)"
					}
				},
				{
					"name": "Get All Sports (Active Only)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/sports?active=true",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "sports"],
							"query": [
								{
									"key": "active",
									"value": "true"
								}
							]
						},
						"description": "Get only active sports"
					}
				},
				{
					"name": "Get Single Sport",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/sports/1",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "sports", "1"]
						},
						"description": "Get a single sport by ID with its leagues"
					}
				}
			]
		},
		{
			"name": "Leagues",
			"item": [
				{
					"name": "Get All Leagues",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/leagues",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "leagues"]
						},
						"description": "Get all leagues (73 total)"
					}
				},
				{
					"name": "Get All Leagues (Active Only)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/leagues?active=true",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "leagues"],
							"query": [
								{
									"key": "active",
									"value": "true"
								}
							]
						},
						"description": "Get only active leagues"
					}
				},
				{
					"name": "Get Leagues by Sport",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/leagues?sport_id=1",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "leagues"],
							"query": [
								{
									"key": "sport_id",
									"value": "1"
								}
							]
						},
						"description": "Get leagues for a specific sport"
					}
				},
				{
					"name": "Get Single League",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/leagues/4",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "leagues", "4"]
						},
						"description": "Get a single league by ID"
					}
				}
			]
		},
		{
			"name": "Events",
			"item": [
				{
					"name": "Get All Events",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/events",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "events"]
						},
						"description": "Get all upcoming and live events (default behavior)"
					}
				},
				{
					"name": "Get NFL Events",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/events?league_key=americanfootball_nfl",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "events"],
							"query": [
								{
									"key": "league_key",
									"value": "americanfootball_nfl"
								}
							]
						},
						"description": "Get all NFL events"
					}
				},
				{
					"name": "Get NBA Events",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/events?league_key=basketball_nba",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "events"],
							"query": [
								{
									"key": "league_key",
									"value": "basketball_nba"
								}
							]
						},
						"description": "Get all NBA events"
					}
				},
				{
					"name": "Get NHL Events",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/events?league_key=icehockey_nhl",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "events"],
							"query": [
								{
									"key": "league_key",
									"value": "icehockey_nhl"
								}
							]
						},
						"description": "Get all NHL events"
					}
				},
				{
					"name": "Get MLB Events",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/events?league_key=baseball_mlb",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "events"],
							"query": [
								{
									"key": "league_key",
									"value": "baseball_mlb"
								}
							]
						},
						"description": "Get all MLB events"
					}
				},
				{
					"name": "Get Upcoming Events",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/events?status=upcoming",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "events"],
							"query": [
								{
									"key": "status",
									"value": "upcoming"
								}
							]
						},
						"description": "Get only upcoming events"
					}
				},
				{
					"name": "Get Live Events",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/events?status=live",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "events"],
							"query": [
								{
									"key": "status",
									"value": "live"
								}
							]
						},
						"description": "Get only live events"
					}
				},
				{
					"name": "Get Completed Events",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/events?status=completed",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "events"],
							"query": [
								{
									"key": "status",
									"value": "completed"
								}
							]
						},
						"description": "Get completed events (last 3 days)"
					}
				},
				{
					"name": "Get Events by Date",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/events?date=2025-11-02",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "events"],
							"query": [
								{
									"key": "date",
									"value": "2025-11-02"
								}
							]
						},
						"description": "Get events for a specific date"
					}
				},
				{
					"name": "Get Single Event",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/events/68",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "events", "68"]
						},
						"description": "Get a single event with BetStack consensus line and result"
					}
				}
			]
		},
		{
			"name": "Lines (Odds)",
			"item": [
				{
					"name": "Get All Lines",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/lines",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "lines"]
						},
						"description": "Get BetStack consensus lines for all major North American leagues (NFL, NBA, NHL, MLB, NCAAF, NCAAB). Returns upcoming/live events only, ordered by start time (soonest first)."
					}
				},
				{
					"name": "Get NFL Lines",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/lines?league_key=americanfootball_nfl",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "lines"],
							"query": [
								{
									"key": "league_key",
									"value": "americanfootball_nfl"
								}
							]
						},
						"description": "Get BetStack consensus lines for NFL events. Ordered by start time (soonest first)."
					}
				},
				{
					"name": "Get DraftKings Lines",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/lines?bookmaker_key=draftkings",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "lines"],
							"query": [
								{
									"key": "bookmaker_key",
									"value": "draftkings"
								}
							]
						},
						"description": "Get DraftKings lines for all major leagues. Override default BetStack consensus with bookmaker_key parameter."
					}
				},
				{
					"name": "Get FanDuel Lines",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/lines?bookmaker_key=fanduel",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "lines"],
							"query": [
								{
									"key": "bookmaker_key",
									"value": "fanduel"
								}
							]
						},
						"description": "Get FanDuel lines for all major leagues. Override default BetStack consensus with bookmaker_key parameter."
					}
				},
				{
					"name": "Get NFL DraftKings Lines",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/lines?league_key=americanfootball_nfl&bookmaker_key=draftkings",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "lines"],
							"query": [
								{
									"key": "league_key",
									"value": "americanfootball_nfl"
								},
								{
									"key": "bookmaker_key",
									"value": "draftkings"
								}
							]
						},
						"description": "Get NFL lines from DraftKings (override default BetStack consensus). Shows how to combine league_key and bookmaker_key filters."
					}
				},
				{
					"name": "Get Lines for Event",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/lines?event_id=68",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "lines"],
							"query": [
								{
									"key": "event_id",
									"value": "68"
								}
							]
						},
						"description": "Get BetStack consensus line for a specific event"
					}
				},
				{
					"name": "Get Lines by Date",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/lines?date=2025-11-02",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "lines"],
							"query": [
								{
									"key": "date",
									"value": "2025-11-02"
								}
							]
						},
						"description": "Get BetStack consensus lines for events on a specific date. Ordered by start time (soonest first)."
					}
				},
				{
					"name": "Get Incomplete Lines",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/lines/incomplete",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "lines", "incomplete"]
						},
						"description": "Get lines with missing market data (missing moneyline, spread, or totals). Returns BetStack consensus lines for major leagues by default."
					}
				},
				{
					"name": "Get Incomplete NFL Lines",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/lines/incomplete?league_key=americanfootball_nfl",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "lines", "incomplete"],
							"query": [
								{
									"key": "league_key",
									"value": "americanfootball_nfl"
								}
							]
						},
						"description": "Get NFL lines with missing market data"
					}
				}
			]
		},
		{
			"name": "Results",
			"item": [
				{
					"name": "Get All Results",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/results",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "results"]
						},
						"description": "Get all results (last 7 days)"
					}
				},
				{
					"name": "Get NFL Results",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/results?league_key=americanfootball_nfl",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "results"],
							"query": [
								{
									"key": "league_key",
									"value": "americanfootball_nfl"
								}
							]
						},
						"description": "Get NFL results only"
					}
				},
				{
					"name": "Get Results by Date",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/results?date=2025-10-28",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "results"],
							"query": [
								{
									"key": "date",
									"value": "2025-10-28"
								}
							]
						},
						"description": "Get results for a specific date"
					}
				},
				{
					"name": "Get Result for Event",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/results?event_id=45",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "results"],
							"query": [
								{
									"key": "event_id",
									"value": "45"
								}
							]
						},
						"description": "Get result for a specific event"
					}
				},
				{
					"name": "Get Single Result",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/results/1",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "results", "1"]
						},
						"description": "Get a single result by ID"
					}
				}
			]
		},
		{
			"name": "Teams",
			"item": [
				{
					"name": "Get All Teams",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/teams",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "teams"]
						},
						"description": "Get all teams"
					}
				},
				{
					"name": "Get All Teams (Active Only)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/teams?active=true",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "teams"],
							"query": [
								{
									"key": "active",
									"value": "true"
								}
							]
						},
						"description": "Get only active teams"
					}
				},
				{
					"name": "Get NFL Teams",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/teams?league_key=americanfootball_nfl",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "teams"],
							"query": [
								{
									"key": "league_key",
									"value": "americanfootball_nfl"
								}
							]
						},
						"description": "Get all NFL teams"
					}
				},
				{
					"name": "Get NBA Teams",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/teams?league_key=basketball_nba",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "teams"],
							"query": [
								{
									"key": "league_key",
									"value": "basketball_nba"
								}
							]
						},
						"description": "Get all NBA teams"
					}
				},
				{
					"name": "Get Single Team",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/teams/120",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "teams", "120"]
						},
						"description": "Get a single team by ID"
					}
				}
			]
		},
		{
			"name": "Bookmakers",
			"item": [
				{
					"name": "Get All Bookmakers",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/bookmakers",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "bookmakers"]
						},
						"description": "Get all bookmakers"
					}
				},
				{
					"name": "Get All Bookmakers (Active Only)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/bookmakers?active=true",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "bookmakers"],
							"query": [
								{
									"key": "active",
									"value": "true"
								}
							]
						},
						"description": "Get only active bookmakers"
					}
				},
				{
					"name": "Get Single Bookmaker",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/bookmakers/8",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "bookmakers", "8"]
						},
						"description": "Get a single bookmaker by ID"
					}
				}
			]
		},
		{
			"name": "Users",
			"item": [
				{
					"name": "Get All Users",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/users",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "users"]
						},
						"description": "Get all users (API keys are not included in list view for security)"
					}
				},
				{
					"name": "Get Single User",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/users/1",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "users", "1"]
						},
						"description": "Get a single user by ID (API key is not included for security)"
					}
				},
				{
					"name": "Create User",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"user@example.com\",\n  \"phone_number\": \"+15551234567\",\n  \"address\": \"123 Main St, City, State 12345\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/users",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "users"]
						},
						"description": "Create a new user. API key is auto-generated and valid for 100 years. Email and phone number are required and must be unique."
					}
				},
				{
					"name": "Update User",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"start_time\": \"2025-01-01T00:00:00Z\",\n  \"end_time\": \"2026-01-01T00:00:00Z\",\n  \"active\": false\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/users/1",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "users", "1"]
						},
						"description": "Update a user. Can modify start_time, end_time, active status, email, phone_number, or address."
					}
				}
			]
		},
		{
			"name": "Cache Testing",
			"item": [
				{
					"name": "Get Lines - Cloudflare Edge (Cache HIT)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Test script for cache status",
									"pm.test(\"Response is successful\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"// Check if response came from Cloudflare",
									"const cacheHeader = pm.response.headers.get(\"X-Cache\");",
									"const serverHeader = pm.response.headers.get(\"Server\");",
									"const responseTime = pm.response.responseTime;",
									"",
									"if (cacheHeader) {",
									"    console.log(\"Cache Status:\", cacheHeader);",
									"    pm.test(\"Response from Cloudflare\", function () {",
									"        pm.expect(serverHeader).to.include(\"cloudflare\");",
									"    });",
									"    ",
									"    if (cacheHeader === \"HIT\") {",
									"        console.log(\"‚úÖ SERVED FROM EDGE CACHE (Fast!)\");",
									"        pm.test(\"Cache HIT - served from edge\", function () {",
									"            pm.expect(cacheHeader).to.eql(\"HIT\");",
									"        });",
									"    } else if (cacheHeader === \"MISS\") {",
									"        console.log(\"‚ö†Ô∏è Cache miss - fetched from origin, now cached\");",
									"    } else {",
									"        console.log(\"üîÑ Bypassed cache - proxied to origin\");",
									"    }",
									"} else {",
									"    console.log(\"üì° Direct request to Heroku (bypassed Cloudflare)\");",
									"}",
									"",
									"// Log response time",
									"console.log(\"Response Time:\", responseTime + \"ms\");",
									"if (responseTime < 100) {",
									"    console.log(\"‚ö° Very fast - likely from edge cache!\");",
									"} else if (responseTime > 200) {",
									"    console.log(\"‚è±Ô∏è Slower response - likely from origin\");",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{edge_url}}/api/v1/lines",
							"host": ["{{edge_url}}"],
							"path": ["api", "v1", "lines"]
						},
						"description": "Test Cloudflare edge caching. Send this request TWICE:\n\n**First request:**\n- X-Cache: MISS (fetched from Heroku, now cached)\n- Response time: ~200-400ms\n\n**Second request (within 2 minutes):**\n- X-Cache: HIT (served from edge cache)\n- Response time: ~10-50ms\n- X-Cache-Status: Cloudflare Edge\n\nCheck the Console tab to see cache status automatically."
					}
				},
				{
					"name": "Get Lines - Direct Heroku (No Cache)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Response is successful\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"const viaHeader = pm.response.headers.get(\"Via\");",
									"const serverHeader = pm.response.headers.get(\"Server\");",
									"const cacheHeader = pm.response.headers.get(\"X-Cache\");",
									"const responseTime = pm.response.responseTime;",
									"",
									"pm.test(\"Direct to Heroku (no Cloudflare)\", function () {",
									"    pm.expect(serverHeader).to.include(\"Heroku\");",
									"    pm.expect(cacheHeader).to.be.undefined;",
									"});",
									"",
									"if (viaHeader) {",
									"    console.log(\"‚úÖ Via header confirms Heroku:\", viaHeader);",
									"}",
									"console.log(\"üì° Direct request to Heroku origin\");",
									"console.log(\"Response Time:\", responseTime + \"ms\");",
									"console.log(\"Server:\", serverHeader);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{production_url}}/api/v1/lines",
							"host": ["{{production_url}}"],
							"path": ["api", "v1", "lines"]
						},
						"description": "Direct request to Heroku origin (bypasses Cloudflare completely).\n\n**Expected headers:**\n- Server: Heroku\n- Via: 1.1 heroku-router\n- No X-Cache header (not through Cloudflare)\n- Response time: ~300-500ms\n\nUse this to compare performance with edge-cached requests."
					}
				},
				{
					"name": "Get Lines - Force Cache Miss",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Response is successful\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"const cacheHeader = pm.response.headers.get(\"X-Cache\");",
									"const viaHeader = pm.response.headers.get(\"Via\");",
									"",
									"console.log(\"Cache-Control: no-cache header forces cache bypass\");",
									"if (cacheHeader === \"MISS\" || cacheHeader === \"BYPASS\") {",
									"    console.log(\"‚úÖ Forced cache miss/bypass - hit Heroku origin\");",
									"    if (viaHeader) {",
									"        console.log(\"Via header:\", viaHeader);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "no-cache",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{edge_url}}/api/v1/lines",
							"host": ["{{edge_url}}"],
							"path": ["api", "v1", "lines"]
						},
						"description": "Force a cache miss even if data is cached. Uses Cache-Control: no-cache header.\n\n**Expected behavior:**\n- X-Cache: MISS or BYPASS\n- Fetches fresh data from Heroku\n- Response time: ~200-400ms\n- Via: 1.1 heroku-router (shows it hit origin)"
					}
				},
				{
					"name": "Get Events - Cloudflare Edge",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Response is successful\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"const cacheHeader = pm.response.headers.get(\"X-Cache\");",
									"const responseTime = pm.response.responseTime;",
									"",
									"if (cacheHeader === \"HIT\") {",
									"    console.log(\"‚úÖ Events served from edge cache\");",
									"} else {",
									"    console.log(\"‚ö†Ô∏è Events fetched from origin\");",
									"}",
									"console.log(\"Response Time:\", responseTime + \"ms\");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{edge_url}}/api/v1/events",
							"host": ["{{edge_url}}"],
							"path": ["api", "v1", "events"]
						},
						"description": "Test edge caching for events endpoint. Send twice to see cache HIT vs MISS."
					}
				},
				{
					"name": "Get Events - Direct Heroku",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{production_url}}/api/v1/events",
							"host": ["{{production_url}}"],
							"path": ["api", "v1", "events"]
						},
						"description": "Direct request to Heroku for events (bypasses Cloudflare)."
					}
				},
				{
					"name": "Get NFL Lines - Edge vs Origin",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Response is successful\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"const cacheHeader = pm.response.headers.get(\"X-Cache\");",
									"const serverHeader = pm.response.headers.get(\"Server\");",
									"",
									"if (cacheHeader === \"HIT\") {",
									"    console.log(\"‚úÖ NFL Lines from edge cache\");",
									"} else if (serverHeader === \"Heroku\") {",
									"    console.log(\"üì° NFL Lines from Heroku origin\");",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{edge_url}}/api/v1/lines?league_key=americanfootball_nfl",
							"host": ["{{edge_url}}"],
							"path": ["api", "v1", "lines"],
							"query": [
								{
									"key": "league_key",
									"value": "americanfootball_nfl"
								}
							]
						},
						"description": "Test edge caching for NFL-specific lines. Compare with direct Heroku request."
					}
				},
				{
					"name": "Get NFL Lines - Direct Heroku",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{production_url}}/api/v1/lines?league_key=americanfootball_nfl",
							"host": ["{{production_url}}"],
							"path": ["api", "v1", "lines"],
							"query": [
								{
									"key": "league_key",
									"value": "americanfootball_nfl"
								}
							]
						},
						"description": "Direct Heroku request for NFL lines. Compare response time with edge version."
					}
				},
				{
					"name": "Create User - Always Bypasses Cache",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const cacheHeader = pm.response.headers.get(\"X-Cache\");",
									"const viaHeader = pm.response.headers.get(\"Via\");",
									"",
									"// User endpoints should always bypass cache",
									"if (cacheHeader === \"BYPASS\" || viaHeader) {",
									"    console.log(\"‚úÖ User endpoint correctly bypassed cache (security)\");",
									"}",
									"",
									"pm.test(\"User endpoint not cached\", function () {",
									"    pm.expect(cacheHeader).to.not.eql(\"HIT\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"test-cache@example.com\",\n  \"phone_number\": \"5551234567\",\n  \"address\": \"123 Test St\"\n}"
						},
						"url": {
							"raw": "{{edge_url}}/api/v1/users",
							"host": ["{{edge_url}}"],
							"path": ["api", "v1", "users"]
						},
						"description": "Test that user endpoints (POST/PUT) always bypass cache and hit Heroku directly.\n\n**Expected:**\n- X-Cache: BYPASS\n- Via: 1.1 heroku-router\n- Always hits origin (write operations never cached)"
					}
				}
			]
		}
	]
}

